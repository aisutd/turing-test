<html>
	<head>
		<title>AIS Turing Test</title>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		
		<script src="/socket.io/socket.io.js"></script>
		<script src="https://code.jquery.com/jquery-1.11.1.js"></script>
		<script>		
			$(function () {
				var socket = io();
				var bot = 'a'
				var human = 'b'

                socket.on('connect', function() {
                    //  Identify as participant
                    socket.emit('identify', 'participant');
                });

                socket.on('disconnect', function() {
                    $('#desc').html('Disconnected from server. Attempting to reconnect...');
                    $('#button-ask').prop('disabled', true);
                });
			
				// Random selection of who is person A/B
				if(Math.random() > 0.5) {
					bot = 'b'
					human = 'a'
				}
				
				$('form').submit(function(){
				  socket.emit('message', $('#response-text').val());
					$('#' + bot + '-messages').append($('<li>').text('You: ' + $('#response-text').val()));
					$('#' + human + '-messages').append($('<li>').text('You: ' + $('#response-text').val()));
				  $('#response-text').val('');
				  return false;
				});

                socket.on('message', function(messages) {
                    let bot_msg = messages.bot;
                    let human_msg = messages.person;
				  $('#' + bot + '-messages').append($('<li>').text('Response: ' + bot_msg));
					$('#' + human + '-messages').append($('<li>').text('Response: ' + human_msg));
				});

                socket.on('status', function(s) {
                    if(typeof s.ready == 'boolean') {
                        $('#button-ask').prop('disabled', !s.ready);
                    }
                    if(typeof s.message == 'string') {
                        $('#desc').html(s.message);
                    }
                });

                socket.on('reset', function() {
                     $('#a-messages').html('');
                     $('#b-messages').html('');
                });
			});
			
		</script>
	</head>
	<body>
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-12">
					<h1>Artificial Intelligence Society: Turing Test</h1>
					<p id=desc>
						***DESCRIPTION***
					</p>
				</div>
			</div>
			<div class="row">
				<div class="col-md-6">
					<h2>Person A</h2>
					<ul id="a-messages"></ul>
				</div>
				<div class="col-md-6">
					<h2>Person B</h2>
						<ul id="b-messages"></ul>
				</div>
			</div>
			
			<div class="row">
				<div class="col-md-12">
					<form action="">
						<textarea id="response-text" rows="3" cols="80"></textarea>
						<button id="button-ask" class="btn btn-primary" disabled=true>Send</button>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>


